# 服务治理

### 一个规范的服务  

- 第一要有**监控记录**，便于分析
- 第二是规范开发流程，首先是开发者自身的提高(可以通过整理常见问题并分享避免很多坏味道的代码或设计)，其次对于开发和测试环节，制定相应的规范，通过工具避免线上的超时
- 第三是问题定期处理(慢SQL、错误日志）  
- 第四是问题总结分享，避免问题 



### 解决思路

1、针对以上问题已排查原因，分配到相应的负责人，并落实  

2、开发规范、前后端校验规范  

3、生产日志处理，减少错误日志，定期清理生产错误日志，具体实施方案需进一步细化  

4、开发常见问题整理及解决思路分享，提升开发者的代码质量，  整理一套SQL开发流程。具体实施方案需进一步细化  

5、 定期优化慢SQL 



### 服务日志

由于开发的不规范，有时候可能什么日志都进行打印。当流量大的时候，如果文件或者base64这些字段打印出来，很容易将服务搞垮。

建议：

- 流量高峰期，将日志调整为error级别
- 无关的日志不要打印
- 内容过长的无用信息不建议打印，或者需要进行截取
- 适当的进行日志截取



建议：

- 错误信息最好和定位到哪一块系统，意味着错误码是唯一的。实际上有些人喜欢用同一个错误码，这样定位问题的时候很不方面。
- 对于已经重要业务，需将日志存储到mongo中，便于后续问题排查，另外还至少需要一个msgId和一个refNo作为索引，方便搜索。
  一些开发人员喜欢什么日志都用log4j2，但是当流量高峰期时，是会进行日志级别调整的，因此不可取，而且不方便查询。
- DDD中台架构，核心业务和非核心业务拆分，服务编排。